---
import NavBar from "../components/NavBar.astro";
import StarField from "../components/StarField.astro";
import SocialLinks from "../components/SocialLinks.astro";
import BackToTop from "../components/BackToTop.astro";
import '../styles/fonts.css';
import '../styles/tailwind.css';
import '../styles/design-system.css';
import { execSync } from 'child_process';

interface Props {
    title: string;
    description?: string;
    ogType?: string;
}

const { title, description = "Nick Russo - Software Engineer", ogType = "website" } = Astro.props;

// Get git commit hash at build time
const gitHash = execSync('git rev-parse --short HEAD').toString().trim();
const pathname = Astro.url.pathname;
const canonicalURL = new URL(pathname, Astro.site);
---

<!doctype html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <link rel="icon" type="image/svg+xml" href="/favicon.ico" />
        <meta name="generator" content={Astro.generator} />
        <meta name="description" content={description} />
        <title>{title}</title>

        <!-- Canonical URL -->
        <link rel="canonical" href={canonicalURL} />

        <!-- Open Graph / Facebook -->
        <meta property="og:type" content={ogType} />
        <meta property="og:url" content={canonicalURL} />
        <meta property="og:title" content={title} />
        <meta property="og:description" content={description} />
        <meta property="og:site_name" content="Nick Russo" />

        <!-- Twitter -->
        <meta property="twitter:card" content="summary" />
        <meta property="twitter:url" content={canonicalURL} />
        <meta property="twitter:title" content={title} />
        <meta property="twitter:description" content={description} />
        <meta property="twitter:creator" content="@nijaru0x" />

        <!-- Preload Inter font for better performance -->
        <link rel="preload" href="/fonts/InterVariable.woff2" as="font" type="font/woff2" crossorigin>
        <!-- Devicons for programming language and tool icons -->
        <link href="https://cdn.jsdelivr.net/gh/devicons/devicon@latest/devicon.min.css" rel="stylesheet">

        <slot name="head" />
    </head>
    <body class="min-h-screen" style="background-color: var(--color-background); color: var(--color-text-primary);">
        <StarField />
        <NavBar />

        <main class="pt-24 pb-16 min-h-screen">
            <slot />
        </main>
        
        <footer class="border-t py-8 text-center" style="border-color: var(--color-border-subtle);">
            <div class="container container-md">
                <p class="body-small text-text-tertiary">© {new Date().getFullYear()} Nick Russo • Built with <a href="https://astro.build" target="_blank" rel="noopener noreferrer" class="link-primary">Astro</a></p>
                <p class="text-xs mt-2" style="color: #08090a; user-select: text;">{gitHash}</p>
            </div>
        </footer>
        
        <BackToTop />
    </body>
</html>

<style is:global>
    @keyframes twinkle {
        0%,
        100% {
            opacity: 0.2;
        }
        50% {
            opacity: 1;
        }
    }

    @keyframes float {
        0%,
        100% {
            transform: translateY(0);
        }
        50% {
            transform: translateY(-10px);
        }
    }

    @keyframes shine {
        0% {
            background-position: -100% 0;
        }
        100% {
            background-position: 200% 0;
        }
    }

    .shine-text {
        position: relative;
    }

    .shine-text::after {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: linear-gradient(
            90deg,
            rgba(255, 255, 255, 0) 0%,
            rgba(255, 255, 255, 0.2) 50%,
            rgba(255, 255, 255, 0) 100%
        );
        background-size: 200% 100%;
        animation: shine 4s ease-in-out infinite;
        pointer-events: none;
    }

    html {
        scroll-behavior: smooth;
    }

    body {
        font-family:
            "Inter",
            system-ui,
            -apple-system,
            BlinkMacSystemFont,
            "Segoe UI",
            Roboto,
            "Helvetica Neue",
            Arial,
            sans-serif;
        font-weight: 400;
        color: #ffffff;
    }

    /* Monospace font for code elements */
    code, pre, .font-mono {
        font-family:
            "SF Mono",
            Monaco,
            "Inconsolata",
            "Roboto Mono",
            "Source Code Pro",
            Consolas,
            "Liberation Mono",
            Menlo,
            monospace;
    }

    /* Custom scrollbar */
    ::-webkit-scrollbar {
        width: 8px;
    }

    ::-webkit-scrollbar-track {
        background: #000000; /* dark-950 */
    }

    ::-webkit-scrollbar-thumb {
        background: #1a1a1a; /* dark-800 */
        border-radius: 4px;
    }

    ::-webkit-scrollbar-thumb:hover {
        background: #2a2a2a; /* dark-700 */
    }
</style>
